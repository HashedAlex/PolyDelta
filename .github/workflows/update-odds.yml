name: Update Odds & AI Analysis                                                                            
                                                                                                             
  on:                                                                                                        
    schedule:                                                                                                
      # 每小时运行一次 (UTC 时间)                                                                            
      - cron: '0 * * * *'                                                                                    
    workflow_dispatch:  # 允许手动触发                                                                       
                                                                                                             
  jobs:                                                                                                      
    scrape:                                                                                                  
      runs-on: ubuntu-latest                                                                                 
                                                                                                             
      steps:                                                                                                 
        - name: Checkout code                                                                                
          uses: actions/checkout@v4                                                                          
                                                                                                             
        - name: Setup Python                                                                                 
          uses: actions/setup-python@v5                                                                      
          with:                                                                                              
            python-version: '3.11'                                                                           
            cache: 'pip'                                                                                     
            cache-dependency-path: scraper/requirements.txt                                                  
                                                                                                             
        - name: Install dependencies                                                                         
          run: |                                                                                             
            cd scraper                                                                                       
            pip install -r requirements.txt                                                                  
                                                                                                             
        - name: Run scraper                                                                                  
          env:                                                                                               
            DATABASE_URL: ${{ secrets.DATABASE_URL }}                                                        
            ODDS_API_KEY: ${{ secrets.ODDS_API_KEY }}                                                        
            OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}                                            
          run: |                                                                                             
            cd scraper                                                                                       
            python scraper.py                                                                                
                                                                                                             
        - name: Log completion                                                                               
          run: |                                                                                             
            echo "✅ Scraper completed at $(date)"  
