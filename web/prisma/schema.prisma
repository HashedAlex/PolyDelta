generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model MarketOdds {
  id                 Int       @id @default(autoincrement())
  sport_type         String    @db.VarChar(20)
  team_name          String    @db.VarChar(100)
  web2_odds          Float?
  polymarket_price   Float?
  polymarket_url     String?
  kalshi_price       Float?
  kalshi_url         String?
  last_updated       DateTime? @default(now()) @db.Timestamp(6)
  source_bookmaker   String?   @db.VarChar(50)
  source_url         String?
  ai_analysis        String?
  analysis_timestamp DateTime? @db.Timestamp(6)
  liquidity_usdc     Float?

  @@index([sport_type, team_name], map: "idx_sport_team")
  @@index([sport_type], map: "idx_sport_type")
  @@index([team_name], map: "idx_team_name")
  @@map("market_odds")
}

model DailyMatch {
  id                 Int       @id @default(autoincrement())
  sport_type         String    @db.VarChar(20)
  match_id           String    @db.VarChar(100)
  home_team          String    @db.VarChar(100)
  away_team          String    @db.VarChar(100)
  commence_time      DateTime  @db.Timestamp(6)
  web2_home_odds     Float?
  web2_away_odds     Float?
  source_bookmaker   String?   @db.VarChar(50)
  source_url         String?
  poly_home_price    Float?
  poly_away_price    Float?
  polymarket_url     String?
  last_updated       DateTime? @default(now()) @db.Timestamp(6)
  ai_analysis        String?
  analysis_timestamp DateTime? @db.Timestamp(6)
  liquidity_away     Float?
  liquidity_home     Float?

  @@unique([sport_type, match_id])
  @@index([sport_type], map: "idx_daily_sport")
  @@index([commence_time], map: "idx_daily_time")
  @@map("daily_matches")
}

model OddsHistory {
  id               Int      @id @default(autoincrement())
  event_type       String   @db.VarChar(20)
  event_id         String   @db.VarChar(100)
  sport_type       String   @db.VarChar(20)
  web2_odds        Float?
  polymarket_price Float?
  recorded_at      DateTime @default(now()) @db.Timestamp(6)

  @@index([event_type, event_id], map: "idx_history_event")
  @@index([sport_type], map: "idx_history_sport")
  @@index([recorded_at], map: "idx_history_time")
  @@map("odds_history")
}
